name: Sync GitHub to Gitee

on:
  workflow_dispatch:
  workflow_run:
    workflows:
      - "Update Content"
    types: [completed]

jobs:
  sync-repos:
    runs-on: windows-latest
    env:
      REPO: ${{ github.repository }}
      USER_NAME: "abgox"
      USER_EMAIL: "abgohxf@outlook.com"
    steps:
      - name: Checkout
        uses: actions/checkout@v5
        with:
          fetch-depth: 0

      - name: Configure Git
        shell: pwsh
        run: |
          git config --global user.name $env:USER_NAME
          git config --global user.email $env:USER_EMAIL

      - name: Push to Gitee
        shell: pwsh
        run: |
          git remote add gitee https://oauth2:${{ secrets.PAT_TOKEN_GITEE }}@gitee.com/$env:REPO.git
          git push gitee --force
          git push gitee --tags --force
